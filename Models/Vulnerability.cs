using System.ComponentModel.DataAnnotations;

namespace Vuln.Models
{
    public class Vulnerability
    {
        required public string Id { get; set; }
        public string Type { get; set; } = "vulnerability";
        required public string Name { get; set; }
        public string Description { get; set; } = "";
        [DataType(DataType.DateTime)]
        required public DateTime Created { get; set; }
        [DataType(DataType.DateTime)]
        required public DateTime Modified { get; set; }
        public List<ExternalReference> ExternalReferences { get; set; } = [];
        public string SpecVersion = "";

        public void ConvertTimesToUTC()
        {
            Created = DateTime.SpecifyKind(Created, DateTimeKind.Utc);
            Modified = DateTime.SpecifyKind(Modified, DateTimeKind.Utc);
        }
    }

    public class ExternalReference
    {
        public Guid Id { get; set; } = Guid.NewGuid();
        required public string SourceName { get; set; }
        public string Description { get; set; } = "";
        public string Url { get; set; } = "";
        // public Dictionary<string, string> Hashes { get; set; } = [];
        public string ExternalId { get; set; } = "";
    }
}